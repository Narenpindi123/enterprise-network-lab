# ============================================================
# ISC DHCP Server Configuration
# Enterprise Network Lab
# ============================================================
# Server: 10.0.10.11 (VLAN 10 — Servers)
# Serves: VLAN 10 (Servers) and VLAN 20 (Clients)
# ============================================================

# --- Global Options ---
option domain-name "enterprise.lab";
option domain-name-servers 10.0.10.10;
default-lease-time 3600;       # 1 hour
max-lease-time 7200;           # 2 hours
authoritative;
log-facility local7;

# --- VLAN 10: Server Subnet ---
subnet 10.0.10.0 netmask 255.255.255.0 {
    range 10.0.10.100 10.0.10.200;
    option routers 10.0.10.1;
    option subnet-mask 255.255.255.0;
    option broadcast-address 10.0.10.255;
    option domain-name-servers 10.0.10.10;
    option domain-name "enterprise.lab";
    default-lease-time 3600;
    max-lease-time 7200;

    # Static reservations for infrastructure servers
    host dns-server {
        hardware ethernet 00:50:56:00:10:10;
        fixed-address 10.0.10.10;
        option host-name "dns";
    }

    host dhcp-server {
        hardware ethernet 00:50:56:00:10:11;
        fixed-address 10.0.10.11;
        option host-name "dhcp";
    }

    host web-server {
        hardware ethernet 00:50:56:00:10:12;
        fixed-address 10.0.10.12;
        option host-name "web";
    }
}

# --- VLAN 20: Client Subnet ---
subnet 10.0.20.0 netmask 255.255.255.0 {
    range 10.0.20.100 10.0.20.200;
    option routers 10.0.20.1;
    option subnet-mask 255.255.255.0;
    option broadcast-address 10.0.20.255;
    option domain-name-servers 10.0.10.10;
    option domain-name "enterprise.lab";
    default-lease-time 3600;
    max-lease-time 7200;
}

# ============================================================
# Verification Commands:
#   sudo systemctl status isc-dhcp-server
#   sudo dhcp-lease-list                    — View active leases
#   cat /var/lib/dhcp/dhcpd.leases          — Raw lease file
#   journalctl -u isc-dhcp-server -f        — Live logs
#
# Client-side Testing:
#   sudo dhclient -v eth0                   — Request a lease
#   ip addr show eth0                       — Verify assigned IP
#   cat /etc/resolv.conf                    — Verify DNS pushed
# ============================================================
