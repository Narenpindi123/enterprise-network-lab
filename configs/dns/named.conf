// ============================================================
// BIND9 DNS Server Configuration
// Enterprise Network Lab
// ============================================================
// Server: 10.0.10.10 (VLAN 10 — Servers)
// Zone: enterprise.lab (internal)
// ============================================================

// --- Global Options ---
options {
    directory "/var/cache/bind";

    // Listen on internal interfaces only
    listen-on { 127.0.0.1; 10.0.10.10; };
    listen-on-v6 { none; };

    // Allow queries from internal VLANs
    allow-query {
        localhost;
        10.0.10.0/24;    // VLAN 10 — Servers
        10.0.20.0/24;    // VLAN 20 — Clients
    };

    // Forward external queries to public DNS
    forwarders {
        8.8.8.8;
        8.8.4.4;
    };
    forward only;

    // Security
    recursion yes;
    allow-recursion {
        localhost;
        10.0.10.0/24;
        10.0.20.0/24;
    };

    dnssec-validation auto;
    auth-nxdomain no;

    // Logging
    querylog yes;
};

// --- Internal Zone: enterprise.lab ---
zone "enterprise.lab" {
    type master;
    file "/etc/bind/zones/db.enterprise.lab";
    allow-update { none; };
};

// --- Reverse Zone: 10.0.10.x ---
zone "10.0.10.in-addr.arpa" {
    type master;
    file "/etc/bind/zones/db.10.0.10";
    allow-update { none; };
};

// --- Reverse Zone: 10.0.20.x ---
zone "20.0.10.in-addr.arpa" {
    type master;
    file "/etc/bind/zones/db.10.0.20";
    allow-update { none; };
};
